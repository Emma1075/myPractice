<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>recharge</title>
  <link rel="stylesheet" href="css/style.css">
  <link href="css/bootstrap-combined.min.css" rel="stylesheet">
  <script type="text/javascript" src="js/jquery-2.0.0.min.js"></script>
</head>
<body>
  <div id="content">
    <div class="row">
      <button class="btn reset">reset</button>
      <button class="btn submit">submit</button>
    </div> 

    <div class="selections">
      <!-- 单选 -->
      <div class="single-selection">
        <p class="description">单选</p>
        <ul>
          <li class="item">100元</li>
          <li class="item">300元</li>
          <li class="item">500元</li>
          <li class="item">1000元</li>
          <li class="item">1500元</li>
          <li class="item">2000元</li>
        </ul>
        <hr>
      </div>    
  
      <!-- 多选 -->
      <div class="multi-selection">
        <p class="description">多选</p>
        <ul>
          <li class="item">100元</li>
          <li class="item">300元</li>
          <li class="item">500元</li>
          <li class="item">1000元</li>
          <li class="item">1500元</li>
          <li class="item">2000元</li>
        </ul>
        <hr>      
      </div>  
  
      <!-- 只能选3个 -->
      <div class="special-selection">
        <p class="description">只能选3个</p>    
        <ul>
          <li class="item">100元</li>
          <li class="item">300元</li>
          <li class="item">500元</li>
          <li class="item">1000元</li>
          <li class="item">1500元</li>
          <li class="item">2000元</li>
        </ul>
      </div>      
    </div>
  </div>

<script>

  $(function(){
    // 单选.点击元素被选中，其它元素被取消
    $('.single-selection .item').on('click', function(e) {
      defaultClass(e);
      $(this).addClass('active');
      $(this).siblings('.item').removeClass('active');
    })
    
    // 多选.点一下选中，再点一下取消
    $('.multi-selection .item').on('click', function(e) {
      defaultClass(e);      
      // 如果是选中状态，则取消；反正则选中
      if ($(this).hasClass('active')) {
        $(this).removeClass('active');
      } else {
        $(this).addClass('active');
      }
    })

    // 特别的多选：只能选3个.第四个被选中时，第一个被选中的li元素取消选中状态。
    var arr = []; // 通过数组来存放选中元素的索引
    $('.special-selection .item').on('click', function(e) {
      defaultClass(e);
      $('.special-selection .item').each(function() {
        $(this).attr('class', 'item');
      })
      
      var index = $(this).index();  // 获取索引
      // 如果数组里没有这个索引值，则加入
      if (arr.indexOf(index) == -1) {
        arr.push(index);  
      } else {
        // 否则，删除该索引
        arr.splice(arr.indexOf(index), 1);  
      }
      // 如果数组长度大于3，删除数组的第一个元素
      if (arr.length > 3) {
        arr.shift();  
      };

      arr.forEach(function(ele) {
        $('.special-selection li').eq(ele).addClass('active');
      })
    })

    // 按钮
    $('.reset').on('click', function(e) {
      $('ul li').removeClass('active');
    })
    
    $('.submit').on('click', function(e) {
      var text = $('ul li').filter('.active').text();
      console.log(text);
    })     
  })

// 删除active样式，恢复默认样式
function defaultClass(e) {
  var e = event || window.event;
  var target = e.target;
  var otherLi = $(target).parent().parent() // 当前li所在div
  .siblings()   // 当前div的兄弟节点div
  .children('ul').children('li');   // 兄弟div下的li

  $(otherLi).removeClass('active');
}

</script>
</body>
</html>
